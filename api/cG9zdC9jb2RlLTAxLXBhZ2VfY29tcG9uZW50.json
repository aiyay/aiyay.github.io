{"title":"Page组件（react+typescript应用）","date":"2018-09-28T07:17:53.000Z","author":"aiyay","excerpt":"","slug":"code-01-page_component","dropcap":true,"tags":["react","typescript"],"categories":["code"],"updated":"2018-09-28T07:50:06.466Z","content":"<link rel=\"stylesheet\" class=\"aplayer-secondary-style-marker\" href=\"\\assets\\css\\APlayer.min.css\"><script src=\"\\assets\\js\\APlayer.min.js\" class=\"aplayer-secondary-script-marker\"></script><script class=\"meting-secondary-script-marker\" src=\"\\assets\\js\\Meting.min.js\"></script><hr>\n<p>Paging.css</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">.Paging&#123;</span><br><span class=\"line\">\t</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">.Paging-mian&#123;</span><br><span class=\"line\">\tdisplay: inline-flex;</span><br><span class=\"line\">\tjustify-content: space-between;</span><br><span class=\"line\">\tlist-style: none;</span><br><span class=\"line\">\tpadding: 0;</span><br><span class=\"line\">\tmargin: 0;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">.Paging-mian li&#123;</span><br><span class=\"line\">\tfont-size: 14px;</span><br><span class=\"line\">\tcursor: pointer;</span><br><span class=\"line\">\twidth: 40px;</span><br><span class=\"line\">\theight: 40px;</span><br><span class=\"line\">\tline-height: 40px;</span><br><span class=\"line\">\tborder: 1px solid #e6e6e6;</span><br><span class=\"line\">\tuser-select: none;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">.Paging-mian li:hover&#123;</span><br><span class=\"line\">\tbackground-color: rgba(127, 146, 255,0.5);</span><br><span class=\"line\">\tcolor: aliceblue;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">.Paging-mian li:first-of-type,li:last-of-type&#123;</span><br><span class=\"line\">\tcursor: pointer;</span><br><span class=\"line\">\twidth: 60px;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">.Paging-active&#123;</span><br><span class=\"line\">\tbackground-color: rgb(127, 146, 255);</span><br><span class=\"line\">\tcolor: aliceblue;</span><br><span class=\"line\">\tborder-color: rgb(127, 146, 255);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">.Paging-disabled&#123;</span><br><span class=\"line\">\tcolor: #b5b5b5;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n<hr>\n<p>Paging.tsx<br><figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br><span class=\"line\">97</span><br><span class=\"line\">98</span><br><span class=\"line\">99</span><br><span class=\"line\">100</span><br><span class=\"line\">101</span><br><span class=\"line\">102</span><br><span class=\"line\">103</span><br><span class=\"line\">104</span><br><span class=\"line\">105</span><br><span class=\"line\">106</span><br><span class=\"line\">107</span><br><span class=\"line\">108</span><br><span class=\"line\">109</span><br><span class=\"line\">110</span><br><span class=\"line\">111</span><br><span class=\"line\">112</span><br><span class=\"line\">113</span><br><span class=\"line\">114</span><br><span class=\"line\">115</span><br><span class=\"line\">116</span><br><span class=\"line\">117</span><br><span class=\"line\">118</span><br><span class=\"line\">119</span><br><span class=\"line\">120</span><br><span class=\"line\">121</span><br><span class=\"line\">122</span><br><span class=\"line\">123</span><br><span class=\"line\">124</span><br><span class=\"line\">125</span><br><span class=\"line\">126</span><br><span class=\"line\">127</span><br><span class=\"line\">128</span><br><span class=\"line\">129</span><br><span class=\"line\">130</span><br><span class=\"line\">131</span><br><span class=\"line\">132</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">import * as React from &apos;react&apos;;</span><br><span class=\"line\">import &apos;./Paging.css&apos;;</span><br><span class=\"line\">interface IPagingProps &#123;</span><br><span class=\"line\">  config: object;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">interface IPagingState &#123;</span><br><span class=\"line\">  groupCount: number;</span><br><span class=\"line\">  moreCount: number;</span><br><span class=\"line\">  pageCurr: number;</span><br><span class=\"line\">  startPage: number;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">class Paging extends React.Component&lt;IPagingProps,IPagingState&gt; &#123;</span><br><span class=\"line\">  public state:IPagingState;</span><br><span class=\"line\">  constructor(props: IPagingProps)&#123;</span><br><span class=\"line\">    super(props);</span><br><span class=\"line\">    this.state = &#123;</span><br><span class=\"line\">      groupCount: 10, // 默认组</span><br><span class=\"line\">      moreCount: 2, // 超出默认组</span><br><span class=\"line\">      pageCurr: 1, // 当前页</span><br><span class=\"line\">      startPage: 1,  // 开始页</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">  &#125;;</span><br><span class=\"line\">  // 构建页数</span><br><span class=\"line\">  public buildPage() &#123;</span><br><span class=\"line\">    const &#123; totalPage &#125;:any = this.props.config;</span><br><span class=\"line\">    const &#123; groupCount,moreCount,pageCurr,startPage &#125; = this.state;</span><br><span class=\"line\">    const pages = [];</span><br><span class=\"line\">    pages.push(&lt;li onClick = &#123; this.previous.bind(this,pageCurr) &#125; className = &#123; pageCurr === 1? &quot;Paging-disabled&quot;: &quot;&quot; &#125; key=&#123;0&#125;&gt;上一页&lt;/li&gt;);</span><br><span class=\"line\">    if(totalPage &lt;= groupCount)&#123;</span><br><span class=\"line\">      for(let i = startPage; i &lt;= totalPage; i++)&#123;</span><br><span class=\"line\">        pages.push(&lt;li onClick = &#123; this.go.bind(this,i) &#125; className = &#123; pageCurr === i ? &quot;Paging-active&quot; : &quot;&quot; &#125; key=&#123;i&#125;&gt;&#123;i&#125;&lt;/li&gt;);</span><br><span class=\"line\">      &#125;</span><br><span class=\"line\">    &#125; else &#123;</span><br><span class=\"line\">      // 页数过半</span><br><span class=\"line\">      if(startPage &gt;= totalPage/2)&#123;</span><br><span class=\"line\">        for(let i = 1; i &lt;= moreCount; i++)&#123;</span><br><span class=\"line\">          pages.push(&lt;li onClick = &#123; this.go.bind(this,i) &#125; className = &#123; pageCurr === i ? &quot;Paging-active&quot; : &quot;&quot; &#125; key=&#123;i&#125;&gt;&#123;i&#125;&lt;/li&gt;);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        pages.push(&lt;li  key=&#123;-1&#125;&gt;...&lt;/li&gt;);</span><br><span class=\"line\">        for(let i = startPage; i &lt;= (((startPage+groupCount-moreCount-1) &gt; totalPage)?totalPage:(startPage+groupCount-moreCount-2)); i++)&#123;</span><br><span class=\"line\">          pages.push(&lt;li onClick = &#123; this.go.bind(this,i) &#125; className = &#123; pageCurr === i ? &quot;Paging-active&quot; : &quot;&quot; &#125; key=&#123;i&#125;&gt;&#123;i&#125;&lt;/li&gt;);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">      &#125; else &#123;</span><br><span class=\"line\">        // 页数未过半</span><br><span class=\"line\">        for(let i = startPage; i &lt; startPage+groupCount-moreCount-1; i++)&#123;</span><br><span class=\"line\">          pages.push(&lt;li onClick = &#123; this.go.bind(this,i) &#125; className = &#123; pageCurr === i ? &quot;Paging-active&quot; : &quot;&quot; &#125; key=&#123;i&#125;&gt;&#123;i&#125;&lt;/li&gt;);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        pages.push(&lt;li  key=&#123;-1&#125;&gt;...&lt;/li&gt;);</span><br><span class=\"line\">        for(let i = moreCount-1; i &gt;= 0; i--)&#123;</span><br><span class=\"line\">          pages.push(&lt;li onClick = &#123; this.go.bind(this,totalPage-i) &#125; className = &#123; pageCurr === totalPage-i ? &quot;Paging-active&quot; : &quot;&quot; &#125; key=&#123;totalPage-i&#125;&gt;&#123;totalPage-i&#125;&lt;/li&gt;);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">      &#125;</span><br><span class=\"line\">    &#125; </span><br><span class=\"line\">    pages.push(&lt;li onClick = &#123; this.next.bind(this,pageCurr) &#125;  className = &#123; pageCurr === totalPage? &quot;Paging-disabled&quot;: &quot;&quot; &#125; key=&#123;totalPage + 1&#125;&gt;下一页&lt;/li&gt;);</span><br><span class=\"line\">    return pages;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  // 更新当前页</span><br><span class=\"line\">  public go(pageCurr:number)&#123;</span><br><span class=\"line\">    const &#123; totalPage &#125;:any = this.props.config;</span><br><span class=\"line\">    const &#123;groupCount,moreCount&#125; = this.state;</span><br><span class=\"line\">    const remainCount = groupCount - moreCount -1;</span><br><span class=\"line\">    // 处理未过半页数</span><br><span class=\"line\">    if(pageCurr &lt; totalPage/2)&#123;</span><br><span class=\"line\">      if(pageCurr &lt; remainCount)&#123;</span><br><span class=\"line\">        this.setState(&#123;</span><br><span class=\"line\">          startPage:1</span><br><span class=\"line\">        &#125;)</span><br><span class=\"line\">      &#125;</span><br><span class=\"line\">      // 处理下一页</span><br><span class=\"line\">      if(pageCurr % remainCount === 1)&#123;</span><br><span class=\"line\">        this.setState(&#123;</span><br><span class=\"line\">            startPage:pageCurr</span><br><span class=\"line\">        &#125;)</span><br><span class=\"line\">      &#125;</span><br><span class=\"line\">      // 处理上一页</span><br><span class=\"line\">      if(pageCurr % remainCount === 0)&#123;</span><br><span class=\"line\">        this.setState(&#123;</span><br><span class=\"line\">            startPage:pageCurr - remainCount + 1</span><br><span class=\"line\">        &#125;)</span><br><span class=\"line\">      &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    // 处理已过半页数</span><br><span class=\"line\">    if(pageCurr &gt;= totalPage/2)&#123;</span><br><span class=\"line\">      if(pageCurr &gt;= (totalPage - (totalPage%remainCount) + 1))&#123;</span><br><span class=\"line\">        this.setState(&#123;</span><br><span class=\"line\">          startPage: totalPage - (totalPage%remainCount) + 1</span><br><span class=\"line\">        &#125;)</span><br><span class=\"line\">      &#125;</span><br><span class=\"line\">      // 处理上一页</span><br><span class=\"line\">      if(pageCurr % remainCount === 0)&#123;</span><br><span class=\"line\">        this.setState(&#123;</span><br><span class=\"line\">            startPage:pageCurr - remainCount + 1</span><br><span class=\"line\">        &#125;)</span><br><span class=\"line\">      &#125;</span><br><span class=\"line\">      // 处理下一页</span><br><span class=\"line\">      if(pageCurr % remainCount === 1)&#123;</span><br><span class=\"line\">        this.setState(&#123;</span><br><span class=\"line\">            startPage:pageCurr</span><br><span class=\"line\">        &#125;)</span><br><span class=\"line\">      &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    this.setState(&#123;</span><br><span class=\"line\">      pageCurr</span><br><span class=\"line\">    &#125;)</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  // 下一页</span><br><span class=\"line\">  public next(pageCurr:number)&#123;</span><br><span class=\"line\">    const &#123; totalPage &#125;:any = this.props.config;</span><br><span class=\"line\">    pageCurr = (pageCurr &gt;= totalPage-1)? totalPage: ++pageCurr;</span><br><span class=\"line\">    this.go(pageCurr);</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  // 上一页</span><br><span class=\"line\">  public previous(pageCurr:number)&#123;</span><br><span class=\"line\">    pageCurr = (pageCurr &lt;= 1)? pageCurr: --pageCurr;</span><br><span class=\"line\">    this.go(pageCurr);</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">  public render() &#123;</span><br><span class=\"line\">    const Pages = this.buildPage.bind(this)();</span><br><span class=\"line\">    return (</span><br><span class=\"line\">      &lt;div className=&quot;Paging&quot;&gt;</span><br><span class=\"line\">        &lt;ul className=&quot;Paging-mian&quot;&gt;</span><br><span class=\"line\">          &#123;Pages&#125;</span><br><span class=\"line\">        &lt;/ul&gt;</span><br><span class=\"line\">      &lt;/div&gt;</span><br><span class=\"line\">    );</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">export default Paging;</span><br></pre></td></tr></table></figure></p>\n<p>App.tsx</p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&lt;Paging config=&#123;&#123; totalPage:30&#125;&#125;/&gt;</span><br></pre></td></tr></table></figure>\n","next":{"title":"我亦好歌亦好酒","slug":"poetry-01"},"link":"/2018/09/28"}